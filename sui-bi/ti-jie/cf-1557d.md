---
description: D. Ezzat and Grid
---

# CF 1557D

## 題目

給你一個高$$N(\leq 3\cdot10^5)$$長$$10^9$$的 01 矩陣。01矩陣會由$$m (\leq 3\cdot10^5)$$個區間$$(h_i,l_i,r_i)$$來表示$$1$$的位置。例如 $$n=3,=6$$時，且區間為$$(1,1,1), (1,7,8), (2,7,7), (2,15,15), (3,1,1), (3,15,15)$$這樣的話該矩陣就會長的像下面這樣：

![&#x53D6;&#x81EA; CF1557D &#x539F;&#x984C;&#x9762;](../../.gitbook/assets/image%20%282%29.png)

請問至少要移除多少行才可以讓這個矩陣變成完美的。其中一個矩陣是完美的若且唯若任意的連續兩行存在相同位置使得兩個位置都是$$1$$。

## 題解

容易想到一個 DP 式$$dp(i)$$代表前$$i$$行必選第$$i$$個最多可以選幾個。而轉移式也可以很輕鬆地列出來：

$$dp(i)=\max\limits_{j<i\ and\ a[i] \& a[j] > 0}\{dp(j)+1\}$$

有經驗的話就可以很輕鬆地看出套個線段樹優化就結束了~

但是！因為我壓根就忘記了線段樹優化要怎麼用，所以我根本沒發現他可以套線段樹優化\(x。\(然後我賽中就沒有解出來了QQQ。\)

因為沒有發現他是線段樹優化，所以我就想出了另外一個有點不可愛的方法：掃描線+建圖

考慮使用掃描線由左至右的掃過去，



