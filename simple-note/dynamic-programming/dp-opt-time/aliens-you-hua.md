---
description: 施工中
---

# Aliens 優化

## 前言

Aliens 優化是從 IOI 2016 Aliens 來的一個技巧，而大陸其實在 2012 年就已經發明這個演算法了，那邊叫做 wqs二分，有興趣的可以看一下原始論文：

{% file src="../../../.gitbook/assets/qian-xi-yi-lei-er-fen-suan-fa-.pdf" %}

接下來的內容會使用到裡面的例題，而我會用我自己的理解來說明 Aliens 優化。

## 概述

Aliens 優化是用來解決 K-約束問題的一種演算法。什麼叫 K-約束問題呢？

我們會遇到像這樣的問題：給定$$n$$個物品，規定以某種方式選擇若干個物品，而選擇物品的不同會有不同代價，規定**必須**選$$k$$個物品的前提下最大/小化花費。舉個簡單的例子：給你一個長度為$$n$$的序列，叫你恰好劃分成$$k$$段，最大/小化價值；諸如此類的問題，就叫做$$k$$約束問題。

上面這類的 DP 問題的複雜度通常會至少是 $$O(NK)$$的，因為需要$$O(NK)$$的空間複雜度。\(令$$dp(i,j)$$代表前$$i$$個物品選$$k$$個之類的\)。而 Aliens 優化可以將這個複雜度優化到 $$O(NlogC)$$，其中 $$C$$視題目而定。

而 Aliens 優化的使用上有一個先備條件：

令$$f(x)$$代表選恰好$$x$$個物品的最小價值，$$f$$是一個凸函數。也就是$$f(x+1)-f(x)\leq f(x)-f(x-1)$$，或稱差分遞減。

如果滿足上面條件的話就可以使用 Aliens 優化。而這個 trick 雖然放在 DP 優化，但事實上並不是只有 DP 才可以使用。

上面的論文裡面附了兩個很好的例子，一題是黑白生成樹、另一題是APIO Commando那題的改編版。接下來我們用這兩個例子來介紹 Aliens 優化要怎麼使用。讓我們先來看黑白生成樹這題：

### 黑白生成樹

> 給你一張$$n$$點$$m$$邊的無向帶邊權連通圖，每條邊會是黑色或白色，請求出一個恰有$$k$$條白色邊的最小生成樹的權值和。$$1\leq n\leq 5\cdot 10^4,1\leq m\leq10^5$$

[題目連結](https://www.luogu.com.cn/problem/P2619)

一看到這題可能會想要先 Greedy 選完白邊之後再選黑邊。但很可惜這是錯的。如果先選白邊的話可能會影響到樹的連通性，導致一些比較優的黑邊不能被選到。

![&#x4E00;&#x500B;&#x53CD;&#x4F8B;\(&#x7528;&#x7D05;&#x7DDA;&#x4EE3;&#x66FF;&#x767D;&#x7DDA;\)](../../../.gitbook/assets/image%20%285%29.png)

而透過觀察可以發現，這題是一個$$k$$約束問題，那麼我們可以試著用看看 Aliens。

令$$f(x)$$代表恰選$$x$$條白邊的最小生成樹權值和。$$f(x)$$顯然是不能直接求出來的，但是我們可以觀察~~感覺~~可以發現$$f$$是一個下凸函數。

![f\(x\) &#x7684;&#x793A;&#x610F;&#x5716;\(y&#x5EA7;&#x6A19;&#x50C5;&#x4F9B;&#x53C3;&#x8003;\)](../../../.gitbook/assets/image%20%286%29.png)

在上面這張圖中，$$x=4$$的值是最小的，也就是說原圖的最小生成樹會有恰好$$4$$條白邊。這時候如我我們想要求$$f(3)$$呢？$$f(3)$$是沒有辦法被快速求出來的，但我們知道最低點可以用 Kruskal 快速算出來。那如果，我們把$$f(3)$$變成最低點呢？

如果我們能夠製作一個函數，他可以讓$$f(3)$$變成最低點，那麼我們就可以快速求出$$f(3)$$了！問題是這個函數要怎麼製作呢？由於$$f$$這個函數是下凸的，所以如果我們能找到一條在$$x=3$$的切線的話...

![&#x5207;&#x7DDA;&#x793A;&#x610F;&#x5716;](../../../.gitbook/assets/image%20%283%29.png)

如此一來，如果我們用$$f(x)$$去剪掉那條切線，那麼$$x=3$$的點就會是最低點了！

![&#x6E1B;&#x6389;&#x5207;&#x7DDA;&#x4E4B;&#x5F8C;&#x7684;&#x51FD;&#x6578;&#x9577;&#x76F8;](../../../.gitbook/assets/image%20%284%29.png)

既然如此，我們的目標就變成是找到那條切線。具體怎麼找呢

$$\left\{ \begin{array}\{ y=f(x)\\ y=kx+b \end{array} \right.$$，整理一下就可以變成$$b=f(x)-kx$$。不妨令$$g(3)=b$$。如果求出了$$g(3)$$以及該切線的斜率$$k$$，





